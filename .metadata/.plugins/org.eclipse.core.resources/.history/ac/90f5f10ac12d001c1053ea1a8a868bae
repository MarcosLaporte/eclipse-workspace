/*
 * Input.c
 *      Author: Marcos
 */

#include "Input.h"
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

int getInt(char message[]){
	int number;

	printf("%s", message);
	scanf("%d", &number);

	return number;
}

int getLimitedInt(char message[], char errorMessage[], int min, int max){
	int number;

	printf("%s", message);
	scanf("%d", &number);
	while(number < min || number > max){
			printf("%s", errorMessage);
			scanf("%d", &number);
	}

	return number;
}

float getFloat(char message[]){
	float number;

	printf("%s", message);
	scanf("%f", &number);

	return number;
}

float getLimitedFloat(char message[], char errorMessage[], int min, int max){
	float number;

	printf("%s", message);
	scanf("%f", &number);
	while(number < min || number > max){
		printf("%s", errorMessage);
		scanf("%f", &number);
	}

	return number;
}

//Vectores
void getSequentialArrayInt(int list[], int length, char message[], char errorMessage[], int min, int max){
	int i;

	for(i = 0; i < length; i++){
		printf("%s", message);
		scanf("%d", &list[i]);
		while(list[i] < min || list[i] > max){
			printf("%s", errorMessage);
			scanf("%d", &list[i]);
		}
	}
}

void getRandomArrayInt(int list[], int length, char message[], char errorMessage[], int min, int max){
	int i;
	char keepGoing;

	do{
		printf("En qué posición desea ingresar el número?: ");
		scanf("%d", &i);
		while(i < 1 || i > length){
			printf("Ingrese una posición entre 1 y %d: ", length);
			scanf("%d", &i);
		}
		printf("%s", message);
		scanf("%d", &list[i-1]);
		while(list[i-1] < min || list[i-1] > max){
			printf("%s", errorMessage);
			scanf("%d", &list[i-1]);
		}

		printf("Desea continuar? s/n: ");
		fflush(stdin);
		scanf("%c", &keepGoing);
		keepGoing = tolower(keepGoing);
		while(!(keepGoing == 's' || keepGoing == 'n')){
			printf("Si desea continuar escriba 's', si no, 'n': ");
			fflush(stdin);
			scanf("%c", &keepGoing);
			keepGoing = tolower(keepGoing);
		}
	}while(keepGoing == 's');
}

void printArrayInt(char message[], int list[], int length){
	int i;

	printf("%s\n", message);
	for(i = 0; i < length; i++){
		printf("%d\n", list[i]);
	}
}

void getSequentialArrayFloat(float list[], int length, char message[], char errorMessage[], int min, int max){
	int i;

	for(i = 0; i < length; i++){
		printf("%s", message);
		scanf("%f", &list[i]);
		while(list[i] < min || list[i] > max){
			printf("%s", errorMessage);
			scanf("%f", &list[i]);
		}
	}
}

void getRandomArrayFloat(float list[], int length, char message[], char errorMessage[], int min, int max){
	int i;
	char keepGoing;

	do{
		printf("En qué posición desea ingresar el número?: ");
		scanf("%d", &i);
		while(i < 1 || i > length){
			printf("Ingrese una posición entre 1 y %d: ", length);
			scanf("%d", &i);
		}
		printf("%s", message);
		scanf("%f", &list[i-1]);
		while(list[i-1] < min || list[i-1] > max){
			printf("%s", errorMessage);
			scanf("%f", &list[i-1]);
		}

		printf("Desea continuar? s/n: ");
		fflush(stdin);
		scanf("%c", &keepGoing);
		keepGoing = tolower(keepGoing);
		while(!(keepGoing == 's' || keepGoing == 'n')){
			printf("Si desea continuar escriba 's', si no, 'n': ");
			fflush(stdin);
			scanf("%c", &keepGoing);
			keepGoing = tolower(keepGoing);
		}
	}while(keepGoing == 's');
}

void printArrayFloat(char message[], float list[], int length){
	int i;

	printf("%s\n", message);
	for(i = 0; i < length; i++){
		printf("%.2f\n", list[i]);
	}
}

void getString(char message[], char input[], int length){
	printf("%s", message);
	fflush(stdin);
	fgets(input, length, stdin);
	length = strlen(input);
	input[length-1] = '\0';
}

void formatName(char input[]){
	int length;
	length = strlen(input);

	if(input != NULL){
		strlwr(input);
		for(int i = 0; i < length; i++){
			if(i == 0 || isspace(input[i-1])){
				input[i] = toupper(input[i]);
			}
		}
	}
}

int checkAlphabetAndSpace(char input[]){
	int length = strlen(input);
	int Return = 1;
	for(int i = 0; i < length; i++){
		if(length == 0 && isalpha(input[i]) == 0 && isspace(input[i]) == 0){
			Return = 0;
			break;
		}
	}
	return Return;
}

int esInt(char cadena[], int dimension){
	int retorno;
	retorno = 0;
	for(int i = 0; i < dimension && cadena[i] != '\0'; i++){
		if(i == 0 && (cadena[i] == '-' || cadena[i] == '+')){
			continue;
		}
		if(cadena[i] > '9' || cadena[i] < '0'){
			retorno = -1;
			break;
		}
	}

	return retorno;
} //Calcula si es un numero

int getInt(int *pResultado){ //Busca un entero, llama .
	int retorno;
	char auxiliar[3000];
	retorno=-1;

	if(pResultado!=NULL &&
			getString("", auxiliar, sizeof(auxiliar))
		/*myGets(auxiliar, sizeof(auxiliar))*/==0 &&
		esInt(auxiliar, sizeof(auxiliar)) == 0){
		*pResultado= atoi(auxiliar);
		retorno=0;
	}

	return retorno;//Si consiguió un entero, devuelve 0
} //Llama a las dos anteriores

int NumeroEnRango(int* pResultado, char* mensaje, char* mensajeError, int minimo, int maximo) {
	int retorno;
	int numero;
	int r;
	retorno = -1;
	if (pResultado != NULL && mensaje != NULL && mensajeError != NULL && minimo <= maximo) {
		printf("%s", mensaje);
		r=getInt(&numero);
		while( r!=0 || numero < minimo || numero > maximo) {
			printf("%s", mensajeError);
			printf("%s", mensaje);
			r=getInt(&numero);
		}
		*pResultado = numero;
		retorno = 0;
	}
	return retorno;
}

Date getDate(char message[]){
	Date entireDate;

	entireDate.day = getLimitedInt("Ingrese el día: ", "ERROR! Ingrese un día entre 1 y 31: ", 1, 31);
	entireDate.month = getLimitedInt("Ingrese el mes: ", "ERROR! Ingrese un mes entre 1 y 12: ", 1, 12);
	entireDate.year = getLimitedInt("Ingrese el año: ", "ERROR! Ingrese una fecha entre %min y %max:", 1900, 2021);

	return entireDate;
}
